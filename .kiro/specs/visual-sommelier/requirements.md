# Требования к проекту

## Введение

«Визуальный Сомелье» — это мобильное/веб-приложение, которое помогает пользователям понимать сложные бытовые устройства и инструкции без необходимости читать бумажные руководства. Система использует компьютерное зрение (CV) для распознавания устройств и их элементов управления, а также большие языковые модели (LLM) для предоставления понятных объяснений на естественном языке.

## Глоссарий

- **Система** — приложение «Визуальный Сомелье»
- **Пользователь** — человек, использующий приложение для получения помощи с устройством
- **Устройство** — бытовая техника, мебель или гаджет, требующий инструкций (стиральная машина, пульт, мебель IKEA и т.д.)
- **Элемент управления** — кнопка, рычаг, переключатель или другой интерактивный компонент устройства
- **CV-модуль** — компонент системы, отвечающий за компьютерное зрение и распознавание изображений
- **LLM-модуль** — компонент системы, использующий большую языковую модель для генерации объяснений
- **Сессия** — один сеанс взаимодействия пользователя с системой для конкретного устройства

## Требования

### Требование 1

**User Story:** Как пользователь, я хочу сфотографировать устройство и получить его идентификацию, чтобы система понимала, с чем я работаю.

#### Критерии приемки

1. WHEN пользователь загружает фотографию устройства, THEN Система SHALL обработать изображение и попытаться идентифицировать тип устройства
2. WHEN CV-модуль успешно распознает устройство, THEN Система SHALL отобразить название и тип устройства пользователю
3. WHEN CV-модуль не может идентифицировать устройство с достаточной уверенностью, THEN Система SHALL предложить пользователю выбрать тип устройства из списка категорий
4. WHEN изображение имеет недостаточное качество для анализа, THEN Система SHALL уведомить пользователя с рекомендациями по улучшению фотографии
5. THE Система SHALL поддерживать распознавание минимум трех категорий устройств: бытовая техника, пульты дистанционного управления, мебель для сборки

### Требование 2

**User Story:** Как пользователь, я хочу получать объяснения на естественном языке о функциях элементов управления, чтобы понимать, как использовать устройство.

#### Критерии приемки

1. WHEN пользователь задает вопрос о конкретном элементе управления, THEN Система SHALL передать изображение и вопрос в LLM-модуль для анализа
2. WHEN LLM-модуль обрабатывает запрос, THEN Система SHALL вернуть понятное объяснение на языке пользователя в течение 10 секунд
3. WHEN объяснение генерируется, THEN Система SHALL включить информацию о назначении элемента управления и инструкции по его использованию
4. WHEN пользователь указывает на область изображения, THEN Система SHALL идентифицировать элемент управления в этой области и предоставить объяснение
5. THE Система SHALL поддерживать диалоговый режим, позволяя пользователю задавать уточняющие вопросы в рамках одной сессии

### Требование 3

**User Story:** Как пользователь, я хочу получать пошаговые инструкции для выполнения задач, чтобы правильно использовать устройство или собрать мебель.

#### Критерии приемки

1. WHEN пользователь запрашивает инструкцию для конкретной задачи, THEN Система SHALL сгенерировать последовательность шагов с использованием LLM-модуля
2. WHEN инструкция генерируется, THEN Система SHALL представить шаги в нумерованном списке с четкими действиями
3. WHEN пользователь выполняет шаг, THEN Система SHALL позволить отметить шаг как выполненный и перейти к следующему
4. WHEN инструкция содержит визуальные элементы, THEN Система SHALL выделить соответствующие области на исходном изображении
5. WHEN пользователь запрашивает помощь на конкретном шаге, THEN Система SHALL предоставить дополнительные разъяснения для этого шага

### Требование 4

**User Story:** Как пользователь, я хочу использовать камеру в реальном времени для получения мгновенных подсказок, чтобы не делать множество фотографий.

#### Критерии приемки

1. WHEN пользователь активирует режим реального времени, THEN Система SHALL получить доступ к камере устройства и начать потоковую обработку
2. WHEN камера направлена на устройство, THEN CV-модуль SHALL обрабатывать кадры с частотой минимум 1 кадр в секунду
3. WHEN элемент управления обнаружен в кадре, THEN Система SHALL отобразить визуальную метку или подсветку на экране
4. WHEN пользователь нажимает на элемент управления в режиме реального времени, THEN Система SHALL зафиксировать кадр и предоставить объяснение
5. WHEN качество изображения в реальном времени недостаточно, THEN Система SHALL отобразить рекомендации по улучшению освещения или угла съемки

### Требование 5

**User Story:** Как пользователь, я хочу получать объяснения на моем родном языке, чтобы лучше понимать инструкции.

#### Критерии приемки

1. WHEN пользователь впервые запускает приложение, THEN Система SHALL определить язык устройства и установить его как язык интерфейса по умолчанию
2. WHEN пользователь меняет язык в настройках, THEN Система SHALL обновить интерфейс и все последующие объяснения на выбранный язык
3. THE Система SHALL поддерживать минимум три языка: русский, английский, китайский
4. WHEN LLM-модуль генерирует объяснение, THEN Система SHALL обеспечить, что текст соответствует выбранному языку пользователя
5. WHEN интерфейс отображается, THEN Система SHALL использовать культурно-адаптированные форматы для дат, чисел и единиц измерения

### Требование 6

**User Story:** Как пользователь, я хочу сохранять историю моих запросов и устройств, чтобы быстро вернуться к ранее изученным инструкциям.

#### Критерии приемки

1. WHEN пользователь завершает сессию с устройством, THEN Система SHALL сохранить изображение устройства, заданные вопросы и полученные ответы
2. WHEN пользователь открывает историю, THEN Система SHALL отобразить список всех предыдущих сессий с миниатюрами изображений и датами
3. WHEN пользователь выбирает сессию из истории, THEN Система SHALL восстановить все данные сессии, включая изображения и диалог
4. WHEN пользователь удаляет сессию из истории, THEN Система SHALL удалить все связанные данные и освободить хранилище
5. THE Система SHALL хранить историю локально на устройстве пользователя для обеспечения приватности

### Требование 7

**User Story:** Как пользователь, я хочу работать с приложением офлайн для базовых функций, чтобы использовать его без интернет-соединения.

#### Критерии приемки

1. WHEN пользователь открывает приложение без интернет-соединения, THEN Система SHALL отобразить уведомление об ограниченной функциональности
2. WHEN интернет-соединение отсутствует, THEN Система SHALL позволить просматривать сохраненную историю сессий
3. WHEN пользователь пытается получить новое объяснение без интернета, THEN Система SHALL отобразить сообщение о необходимости подключения и предложить сохранить запрос в очередь
4. WHEN интернет-соединение восстанавливается, THEN Система SHALL автоматически обработать запросы из очереди
5. THE Система SHALL кэшировать часто используемые объяснения для доступа в офлайн-режиме

### Требование 8

**User Story:** Как пользователь, я хочу получать предупреждения о безопасности при работе со сложными устройствами, чтобы избежать травм или повреждений.

#### Критерии приемки

1. WHEN LLM-модуль генерирует инструкцию для потенциально опасной операции, THEN Система SHALL включить предупреждение о безопасности в начале объяснения
2. WHEN устройство идентифицировано как электрическое или требующее особой осторожности, THEN Система SHALL отобразить общее предупреждение о безопасности
3. WHEN инструкция содержит шаги с рисками, THEN Система SHALL выделить эти шаги специальным значком предупреждения
4. WHEN пользователь запрашивает информацию о ремонте или разборке, THEN Система SHALL рекомендовать обращение к профессионалу, если это применимо
5. THE Система SHALL включать дисклеймер о том, что рекомендации носят информационный характер и не заменяют официальные инструкции производителя

### Требование 9

**User Story:** Как разработчик, я хочу иметь модульную архитектуру системы, чтобы легко заменять компоненты CV и LLM на альтернативные решения.

#### Критерии приемки

1. WHEN CV-модуль вызывается, THEN Система SHALL использовать единый интерфейс, независимый от конкретной реализации (Google Vision API, OpenCV и т.д.)
2. WHEN LLM-модуль вызывается, THEN Система SHALL использовать единый интерфейс, независимый от конкретного провайдера (OpenAI, Google Gemini и т.д.)
3. WHEN требуется замена CV-провайдера, THEN Система SHALL позволить изменить реализацию без модификации бизнес-логики
4. WHEN требуется замена LLM-провайдера, THEN Система SHALL позволить изменить реализацию через конфигурацию
5. THE Система SHALL разделять слои представления, бизнес-логики и интеграции с внешними сервисами

### Требование 10

**User Story:** Как пользователь, я хочу, чтобы приложение работало быстро и эффективно, чтобы не тратить время на ожидание.

#### Критерии приемки

1. WHEN пользователь загружает изображение, THEN Система SHALL начать обработку в течение 1 секунды
2. WHEN CV-модуль анализирует изображение, THEN Система SHALL завершить базовое распознавание в течение 5 секунд
3. WHEN LLM-модуль генерирует объяснение, THEN Система SHALL вернуть ответ в течение 10 секунд
4. WHEN пользователь взаимодействует с интерфейсом, THEN Система SHALL обеспечить отклик на действия в течение 200 миллисекунд
5. WHEN изображения сохраняются в историю, THEN Система SHALL сжимать их для оптимизации использования хранилища без значительной потери качества
